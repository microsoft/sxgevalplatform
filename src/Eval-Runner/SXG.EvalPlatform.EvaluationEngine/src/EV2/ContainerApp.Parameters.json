{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "Name": {
      "value": "eval-framework-app-__Environment____Region__"
    },
    "Configuration": {
      "value": {
                    "activeRevisionsMode": "Single",
                    "ingress": {
                        "external": false,
                        "targetPort": 0,
                        "exposedPort": 0,
                        "transport": "Auto",
                        "traffic": [
                            {
                                "weight": 100,
                                "latestRevision": true
                            }
                        ],
                        "allowInsecure": false,
                        "stickySessions": {
                            "affinity": "none"
                        }
                    },
                    "registries": [
                        {
                            "server": "evalcontainerregistry__Environment__.azurecr.io",
                            "identity": "/subscriptions/__SubscriptionId__/resourceGroups/__CommonRG__/providers/Microsoft.ManagedIdentity/userAssignedIdentities/sxgevalapi__Environment__-id"
                        }
                    ],
                    "identitySettings": []
                }
    },
    "EnvironmentId": {
      "value": "/subscriptions/__SubscriptionId__/resourcegroups/__RunRG__/providers/Microsoft.App/managedEnvironments/eval-framework-env-__Environment____Region__"
    },
    "ManagedEnvironmentId": {
      "value": "/subscriptions/__SubscriptionId__/resourcegroups/__RunRG__/providers/Microsoft.App/managedEnvironments/eval-framework-env-__Environment____Region__"
    },
    "Template": {
      "value": {
        "Containers": [
          {
            "Args": [],
            "Command": [],
            "Env": [
              {
                "Name": "ApiAuthentication__ClientId",
                "Value": "__AuthenticationClientId__"
              },
              {
                "Name": "ApiAuthentication__EnableAuthentication",
                "Value": "__ApiAuthenticationEnable__"
              },
              {
                "Name": "ApiAuthentication__EnableTokenCaching",
                "Value": "True"
              },
              {
                "Name": "ApiAuthentication__ResourceAppId",
                "Value": "__AuthenticationResourceId__"
              },
              {
                "Name": "ApiAuthentication__Scope",
                "Value": "api://__AuthenticationResourceId__/.default"
              },
              {
                "Name": "ApiAuthentication__TenantId",
                "Value": "72f988bf-86f1-41af-91ab-2d7cd011db47"
              },
              {
                "Name": "ApiAuthentication__TokenRefreshBufferSeconds",
                "Value": "300"
              },
              {
                "Name": "ApiEndpoints__BaseUrl",
                "Value": "https://sxgevalapi__Environment____Region__.azurewebsites.net"
              },
              {
                "Name": "ApiEndpoints__EnrichedDatasetEndpoint",
                "Value": "/api/v1/eval/runs/{EvalRunId}/enriched-dataset"
              },
              {
                "Name": "ApiEndpoints__MetricsConfigurationEndpoint",
                "Value": "/api/v1/eval/configurations/{MetricsConfigurationId}"
              },
              {
                "Name": "ApiEndpoints__PostResultsEndpoint",
                "Value": "/api/v1/eval/runs/{evalRunId}/results"
              },
              {
                "Name": "ApiEndpoints__UpdateStatus",
                "Value": "/api/v1/eval/runs/{evalRunId}/status"
              },
              {
                "Name": "ApiEndpoints__UpdateStatusEndpoint",
                "Value": "/api/v1/eval/runs/{evalRunId}/status"
              },
              {
                "Name": "ApplicationInsights__ConnectionString",
                "Value": "__InstrumentationKey__"
              },
              {
                "Name": "ApplicationInsights__DisableConfigurationUpdates",
                "Value": "True"
              },
              {
                "Name": "ApplicationInsights__EnableConsoleLogging",
                "Value": "True"
              },
              {
                "Name": "ApplicationInsights__EnableTelemetry",
                "Value": "True"
              },
              {
                "Name": "ApplicationInsights__LogLevel__Default",
                "Value": "Information"
              },
              {
                "Name": "ApplicationInsights__LogLevel__Microsoft",
                "Value": "Warning"
              },
              {
                "Name": "ApplicationInsights__LogLevel__System",
                "Value": "Warning"
              },
              {
                "Name": "AzureAI__ProjectId",
                "Value": "/subscriptions/__SubscriptionId__/resourceGroups/__CommonRG__/providers/Microsoft.CognitiveServices/accounts/evalplatform/projects/evalplatformproject__Environment____Region__"
              },
              {
                "Name": "AzureAI__ProjectName",
                "Value": "evalplatformproject__Environment____Region__"
              },
              {
                "Name": "AzureAI__ResourceGroupName",
                "Value": "__CommonRG__"
              },
              {
                "Name": "AzureAI__ResourceName",
                "Value": "evalplatformproject__Environment____Region__"
              },
              {
                "Name": "AzureAI__SubscriptionId",
                "Value": "__SubscriptionId__"
              },
              {
                "Name": "AzureAI__TenantId",
                "Value": "72f988bf-86f1-41af-91ab-2d7cd011db47"
              },
              {
                "Name": "AzureOpenAI__ApiVersion",
                "Value": "2025-01-01-preview"
              },
              {
                "Name": "AzureOpenAI__DeploymentName",
                "Value": "gpt-4.1"
              },
              {
                "Name": "AzureOpenAI__Endpoint",
                "Value": "https://evalplatform__Environment____Region__.openai.azure.com/openai/deployments/gpt-4.1/chat/completions?api-version=2025-01-01-preview"
              },
              {
                "Name": "AzureOpenAI__ResourceGroupName",
                "Value": "__CommonRG__"
              },
              {
                "Name": "AzureOpenAI__ResourceName",
                "Value": "evalplatform__Environment____Region__"
              },
              {
                "Name": "AzureOpenAI__SubscriptionId",
                "Value": "__SubscriptionId__"
              },
              {
                "Name": "AzureOpenAI__TenantId",
                "Value": "72f988bf-86f1-41af-91ab-2d7cd011db47"
              },
              {
                "Name": "AzureStorage__AccountName",
                "Value": "sxgcommonstore__Environment__"
              },
              {
                "Name": "AzureStorage__QueueName",
                "Value": "eval-processing-requests"
              },
              {
                "Name": "Evaluation__MaxParallelMetrics",
                "Value": "2"
              },
              {
                "Name": "Evaluation__MaxParallelPrompts",
                "Value": "2"
              },
              {
                "Name": "Evaluation__QueuePollingIntervalSeconds",
                "Value": "30"
              },
              {
                "Name": "Evaluation__QueueVisibilityTimeoutSeconds",
                "Value": "300"
              },
              {
                "Name": "Evaluation__RetryAttempts",
                "Value": "3"
              },
              {
                "Name": "Evaluation__TimeoutSeconds",
                "Value": "300"
              },
              {
                "Name": "Logging__LogLevel__Default",
                "Value": "Information"
              },
              {
                "Name": "Logging__LogLevel__Microsoft",
                "Value": "Warning"
              },
              {
                "Name": "Logging__LogLevel__System",
                "Value": "Warning"
              },
              {
                "Name": "Logging__LogLevel__azure.core.pipeline.policies.http_logging_policy",
                "Value": "Warning"
              },
              {
                "Name": "Logging__LogLevel__azure.identity",
                "Value": "Warning"
              },
              {
                "Name": "Logging__LogLevel__azure.monitor.opentelemetry.exporter",
                "Value": "Warning"
              },
              {
                "Name": "Logging__LogLevel__eval_runner",
                "Value": "Information"
              },
              {
                "Name": "ManagedIdentity__ClientId",
                "Value": "__ManagedIdentityClientId__"
              },
              {
                "Name": "ManagedIdentity__UseDefaultAzureCredentials",
                "Value": "False"
              },
              {
                "Name": "ManagedIdentity__UseManagedIdentity",
                "Value": "True"
              },
              {
                "Name": "properties.template.scale.maxReplicas",
                "Value": "10"
              }
            ],
            "Image": "__RegistryUrl__/eval-runner-app:EV2Build_Version",
            "ImageType": "ContainerImage",
            "Name": "eval-framework-app-__Environment____Region__",
            "Probes": [],
            "VolumeMounts": []
          }
        ],
        "scale": {
          "minReplicas": 1,
          "maxReplicas": 10,
          "cooldownPeriod": 300,
          "pollingInterval": 30
        },
        "InitContainers": [],
        "ServiceBinds": [],
        "Volumes": []
      }
    },
    "WorkloadProfileName": {
      "value": "Consumption"
    },
    "Identity": {
      "value": {
        "/subscriptions/__SubscriptionId__/resourceGroups/__CommonRG__/providers/Microsoft.ManagedIdentity/userAssignedIdentities/sxgevalapi__Environment__-id": {}
      }
    },
    "LocationProp": {
      "value": "__Location__"
    },
    "newOrExisting": {
      "value": true
    }
  }
}